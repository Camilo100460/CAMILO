let horoscopos = {
    "Capricornio": [
        "Hoy será un gran día para ti.",
        "Deberías evitar tomar decisiones importantes hoy.",
        "Capricornio, hoy te sentirás lleno de determinación y enfoque, listo para enfrentar cualquier desafío que se presente en tu camino. Aprovecha esta energía para avanzar en tus metas profesionales y alcanzar nuevos logros. En el ámbito personal, tu lealtad y dedicación fortalecerán tus relaciones más importantes. Mantén un equilibrio saludable entre el trabajo y el tiempo para ti mismo, ¡y verás cómo alcanzas el éxito en todas las áreas de tu vida!",
        "Hoy, Capricornio, te sentirás inspirado y lleno de creatividad, listo para dar vida a tus ideas más audaces. Tu determinación y perseverancia te llevarán a superar cualquier obstáculo que se interponga en tu camino. En el ámbito financiero, tus decisiones prudentes te permitirán construir una base sólida para tu futuro. Dedica tiempo a cuidar tu bienestar físico y emocional, ¡y verás cómo cada día se llena de nuevas oportunidades!",
        "Capricornio, hoy te espera un día lleno de oportunidades para el crecimiento personal y profesional. Tu disciplina y tu ética de trabajo te ayudarán a alcanzar tus metas con facilidad. En el ámbito personal, tus relaciones se fortalecerán gracias a tu sinceridad y tu compromiso. Recuerda tomarte un tiempo para relajarte y recargar energías, ¡y verás cómo todo se alinea a tu favor!",
        "Hoy, Capricornio, te sentirás en armonía contigo mismo y con el mundo que te rodea. Tu determinación y tu capacidad para superar los desafíos te llevarán hacia el éxito en todas tus empresas. En el ámbito personal, tu lealtad y tu generosidad fortalecerán tus lazos afectivos. Dedica tiempo a cuidar tu bienestar físico y emocional, ¡y verás cómo cada día te acerca más a tus sueños más grandes!",
        "Capricornio, hoy podrías sentirte abrumado por la presión de tus responsabilidades y compromisos. Es posible que te resulte difícil mantener el equilibrio entre el trabajo y tu vida personal, lo que podría generar tensiones en tus relaciones. En el ámbito financiero, evita tomar decisiones apresuradas y asegúrate de pensar cuidadosamente antes de actuar. A pesar de los desafíos, recuerda que tienes la fuerza y la determinación para superar cualquier obstáculo que se interponga en tu camino.",
        "Hoy, Capricornio, podrías encontrarte luchando contra la sensación de estancamiento en tu vida. Es posible que te resulte difícil encontrar la motivación para avanzar en tus metas, lo que podría generar frustración y ansiedad. En el ámbito personal, es importante que te comuniques abierta y honestamente con tus seres queridos para evitar malentendidos. Recuerda que cada desafío es una oportunidad para crecer y aprender, ¡así que mantén la fe en ti mismo y sigue adelante!",
        "Capricornio, hoy podrías sentirte agobiado por la sensación de estar atrapado en una rutina. Es posible que te resulte difícil encontrar la inspiración para seguir adelante, lo que podría afectar tu rendimiento en el trabajo y tus relaciones personales. En el ámbito financiero, es crucial que evites tomar decisiones impulsivas y que te enfoques en mantener un equilibrio saludable en tus gastos. A pesar de los desafíos, recuerda que tienes la fuerza interior para superar cualquier obstáculo que se presente en tu camino.",
        "Hoy, Capricornio, podrías enfrentarte a obstáculos inesperados que pondrán a prueba tu paciencia y tu determinación. Las tensiones en tus relaciones personales podrían aumentar, lo que podría generar conflictos y malentendidos. En el ámbito financiero, es importante que te mantengas firme en tus decisiones y que evites cualquier riesgo innecesario. Aunque te enfrentes a desafíos, recuerda que tienes la capacidad de encontrar soluciones creativas y superar cualquier adversidad que se presente en tu camino."
    ],
    "Acuario": ["Hoy encontrarás algo que has estado buscando.", "Hoy es un buen día para aprender algo nuevo."],
    "Piscis": ["Hoy te sentirás inspirado para crear.", "Hoy es un buen día para relajarte y disfrutar."],
    "Aries": ["Hoy es un buen día para empezar un nuevo proyecto.", "Hoy es un buen día para hacer ejercicio y cuidar tu salud."],
    "Tauro": ["Hoy es un buen día para pasar tiempo con seres queridos.", "Hoy es un buen día para cuidar de ti mismo y relajarte."],
    "Geminis": ["Hoy es un buen día para aprender algo nuevo.", "Hoy es un buen día para expresar tus sentimientos a alguien especial."],
    "Cancer": ["Hoy es un buen día para hacer algo creativo.", "Hoy es un buen día para cuidar de tu salud y bienestar."],
    "Leo": ["Hoy es un buen día para enfrentar un desafío.", "Hoy es un buen día para pasar tiempo con amigos."],
    "Virgo": ["Hoy es un buen día para organizar y planificar.", "Hoy es un buen día para tomar un descanso y relajarte."],
    "Libra": [
        "Libra, hoy tu carisma será contagioso, irradiando una energía positiva que iluminará tu entorno. Aprovecha este día para fortalecer tus lazos afectivos, compartiendo amor y alegría con tus seres queridos. En el ámbito financiero, tus decisiones sabias y estratégicas te conducirán hacia la prosperidad. Dedica tiempo a cuidar tu bienestar físico y emocional, ¡y verás cómo florecen nuevas oportunidades en tu vida!",
        "Hoy, Libra, sentirás una profunda armonía en tu ser, lo que te permitirá manifestar tus deseos con facilidad. Tus relaciones personales se fortalecerán con gestos de amor y comprensión. En cuanto a tus finanzas, tu enfoque y determinación te llevarán hacia el éxito económico. Confía en tu intuición y sigue tu corazón en todas tus decisiones. ¡El universo conspira a tu favor para que alcances tus metas más ambiciosas!",
        "Libra, hoy te espera un día lleno de oportunidades y momentos felices. Tu encanto natural atraerá la atención de quienes te rodean, fortaleciendo tus relaciones interpersonales. En el ámbito financiero, tus habilidades para gestionar tus recursos te permitirán alcanzar la estabilidad y la seguridad económica. Recuerda cuidar tu bienestar físico y emocional, ¡y verás cómo cada día brilla con nuevas posibilidades!",
        "Hoy, Libra, podrías sentirte abrumado por la indecisión y la incertidumbre en tu vida. Las tensiones en tus relaciones personales podrían alcanzar su punto máximo, generando conflictos y malentendidos. Es importante que te tomes un momento para reflexionar y encontrar la paz interior. En cuanto a tus finanzas, evita tomar decisiones impulsivas y sé prudente con tus gastos. Aunque el camino parezca difícil, recuerda que cada desafío te hace más fuerte.",
        "Libra, hoy podrías encontrarte luchando contra obstáculos que parecen insuperables. Las tensiones en tus relaciones personales podrían causar estrés y ansiedad, así que trata de mantener la calma y la compostura. En el ámbito financiero, es crucial que te mantengas firme en tus decisiones y evites cualquier riesgo innecesario. A pesar de los desafíos, recuerda que tienes la fuerza y la determinación para superar cualquier adversidad que se presente en tu camino.",
        "Libra, hoy te espera un día lleno de armonía y equilibrio. Tu capacidad para encontrar soluciones pacíficas en situaciones conflictivas te permitirá fortalecer tus relaciones interpersonales. En el ámbito financiero, tu enfoque y disciplina te ayudarán a alcanzar tus metas económicas. Dedica tiempo a cuidar tu bienestar físico y emocional, ¡y verás cómo todo fluye con facilidad en tu vida!",
        "Hoy, Libra, tu encanto natural estará en su punto más alto, atrayendo la atención y la admiración de quienes te rodean. Aprovecha este día para expresar tu creatividad y tu pasión en todo lo que hagas. En el ámbito financiero, tus decisiones inteligentes te llevarán hacia la prosperidad y el éxito. Confía en tu intuición y sigue tu corazón en todas tus acciones. ¡El universo está conspirando a tu favor para que logres tus sueños más grandes!",
        "Libra, hoy podrías sentirte desanimado por las tensiones en tus relaciones personales. Los conflictos y malentendidos podrían empañar tu día, así que trata de mantener la calma y la compostura. En el ámbito financiero, es importante que evites tomar decisiones impulsivas y que te centres en mantener un equilibrio saludable en tus gastos. Aunque te enfrentes a desafíos, recuerda que cada obstáculo es una oportunidad para crecer y aprender.",
        "Hoy, Libra, podrías encontrarte luchando contra la sensación de estancamiento en tu vida. Es posible que te resulte difícil encontrar la motivación para avanzar en tus metas, lo que podría generar frustración y ansiedad. En el ámbito personal, es importante que te comuniques abierta y honestamente con tus seres queridos para evitar malentendidos. Recuerda que cada desafío es una oportunidad para crecer y aprender, ¡así que mantén la fe en ti mismo y sigue adelante!",
        "Libra, hoy podrías sentirte agobiado por la sensación de estar atrapado en una rutina. Es posible que te resulte difícil encontrar la inspiración para seguir adelante, lo que podría afectar tu rendimiento en el trabajo y tus relaciones personales. En el ámbito financiero, es crucial que evites tomar decisiones impulsivas y que te enfoques en mantener un equilibrio saludable en tus gastos. A pesar de los desafíos, recuerda que tienes la fuerza interior para superar cualquier obstáculo que se presente en tu camino.",
        "Hoy, Libra, podrías enfrentarte a obstáculos inesperados que pondrán a prueba tu paciencia y tu determinación. Las tensiones en tus relaciones personales podrían aumentar, lo que podría generar conflictos y malentendidos. En el ámbito financiero, es importante que te mantengas firme en tus decisiones y que evites cualquier riesgo innecesario. Aunque te enfrentes a desafíos, recuerda que tienes la capacidad de encontrar soluciones creativas y superar cualquier adversidad que se presente en tu camino."
    ],
    "Scorpion": ["Hoy es un buen día para enfrentar tus miedos.", "Hoy es un buen día para compartir tus sentimientos con alguien cercano."],
    "Sagitario": ["Hoy es un buen día para una aventura.", "Hoy es un buen día para aprender algo nuevo."]
}
function agregarHoroscopo(signo, horoscopo) {
    horoscopos[signo].push(horoscopo);
}

function obtenerHoroscopo(signo) {
    let horoscoposSigno = horoscopos[signo];
    let indiceAleatorio = Math.floor(Math.random() * horoscoposSigno.length);
    return horoscoposSigno[indiceAleatorio];
}

let handler = (m, { command, text }) => {
    if (!text) throw `Ejemplo: ${command} 2003 02 25`

    const [year, month, day] = text.match(/\d+/g).map(Number)
    const date = new Date(year, month - 1, day)

    if (isNaN(date)) throw `Fecha inválida, por favor usa el siguiente formato: AAAA MM DD. Por ejemplo: ${command} 2003 02 25`

    const today = new Date()
    const currentYear = today.getFullYear()
    const currentMonth = today.getMonth() + 1
    const currentDay = today.getDate()

    const birth = [year, month, day]
    const horoscopo = obtenerHoroscopo(getZodiac(month, day))

    const ageD = new Date(today - date)
    const age = ageD.getFullYear() - new Date(1970, 0, 1).getFullYear()

    const isBirthday = month === currentMonth && day === currentDay
    const ageText = isBirthday ? `${age} - ¡Feliz cumpleaños! 🥳` : age

    const replyText = `
Fecha de nacimiento: ${birth.join('-')}
Edad: ${ageText}
Signo horóscopo: ${getZodiac(month, day)}
Horóscopo: ${horoscopo}
`.trim()

    m.reply(replyText)
}

handler.help = ['horóscopo <AAAA MM DD>']
handler.tags = ['tools']
handler.command = /^hor[oó]scopo$/i

const zodiak = [
    ["Capricornio", new Date(1970, 0, 1)],
    ["Acuario", new Date(1970, 0, 20)],
    ["Piscis", new Date(1970, 1, 19)],
    ["Aries", new Date(1970, 2, 21)],
    ["Tauro", new Date(1970, 3, 21)],
    ["Geminis", new Date(1970, 4, 21)],
    ["Cancer", new Date(1970, 5, 22)],
    ["Leo", new Date(1970, 6, 23)],
    ["Virgo", new Date(1970, 7, 23)],
    ["Libra", new Date(1970, 8, 23)],
    ["Scorpion", new Date(1970, 9, 23)],
    ["Sagitario", new Date(1970, 10, 22)],
    ["Capricornio", new Date(1970, 11, 22)]
].reverse()

function getZodiac(month, day) {
    let d = new Date(1970, month - 1, day)
    return zodiak.find(([_, _d]) => d >= _d)[0]
}

export default handler
